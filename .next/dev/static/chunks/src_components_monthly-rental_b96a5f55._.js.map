{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/ervin/Documents/Power%20Metal%20%26%20Steel/src/components/monthly-rental/MonthlyRentalInvoiceList.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { Search, Eye, AlertCircle, Calendar, TrendingUp, FileText, MoreVertical, Edit } from 'lucide-react';\nimport { Input } from '../ui/input';\nimport { Card, CardContent, CardHeader, CardTitle } from '../ui/card';\nimport { Badge } from '../ui/badge';\nimport { Button } from '../ui/button';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '../ui/table';\nimport {\n  Select,\n  SelectContent,\n  SelectItem,\n  SelectTrigger,\n  SelectValue,\n} from '../ui/select';\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuTrigger,\n} from '../ui/dropdown-menu';\nimport { MonthlyRentalInvoice } from '../../types/monthly-rental';\n\ninterface MonthlyRentalInvoiceListProps {\n  invoices: MonthlyRentalInvoice[];\n  onView: (id: string) => void;\n  onEditPayment?: (id: string) => void;\n  userRole: 'Admin' | 'Finance' | 'Staff' | 'Customer';\n}\n\nexport function MonthlyRentalInvoiceList({ invoices, onView, onEditPayment, userRole }: MonthlyRentalInvoiceListProps) {\n  const [searchQuery, setSearchQuery] = useState('');\n  const [statusFilter, setStatusFilter] = useState<string>('all');\n\n  const filteredInvoices = invoices.filter(invoice => {\n    const matchesSearch = \n      invoice.invoiceNumber.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      invoice.customerName.toLowerCase().includes(searchQuery.toLowerCase()) ||\n      invoice.deliveryOrderNumber.toLowerCase().includes(searchQuery.toLowerCase());\n    \n    const matchesStatus = statusFilter === 'all' || invoice.status === statusFilter;\n    \n    return matchesSearch && matchesStatus;\n  });\n\n  const isBeforeDueDate = (dueDate: string) => {\n    const now = new Date();\n    const due = new Date(dueDate);\n    now.setHours(0, 0, 0, 0);\n    due.setHours(0, 0, 0, 0);\n    return now <= due;\n  };\n\n  const getStatusBadge = (status: MonthlyRentalInvoice['status']) => {\n    switch (status) {\n      case 'Paid':\n        return <Badge className=\"bg-green-600 hover:bg-green-700 text-white\">Paid</Badge>;\n      case 'Pending Payment':\n        return <Badge className=\"bg-[#EEF5FF] hover:bg-[#E6F0FF] text-[#2F6AE0]\">Pending Payment</Badge>;\n      case 'Pending Approval':\n        return <Badge className=\"bg-blue-600 hover:bg-blue-700 text-white\">Pending Approval</Badge>;\n      case 'Rejected':\n        return <Badge className=\"bg-red-600 hover:bg-red-700 text-white\">Rejected</Badge>;\n      case 'Overdue':\n        return <Badge className=\"bg-orange-600 hover:bg-orange-700 text-white\">Overdue</Badge>;\n      case 'Completed':\n        return <Badge className=\"bg-gray-600 hover:bg-gray-700 text-white\">Completed</Badge>;\n      default:\n        return <Badge>{status}</Badge>;\n    }\n  };\n\n  const stats = {\n    total: invoices.length,\n    pending: invoices.filter(inv => inv.status === 'Pending Payment').length,\n    pendingApproval: invoices.filter(inv => inv.status === 'Pending Approval').length,\n    paid: invoices.filter(inv => inv.status === 'Paid').length,\n    rejected: invoices.filter(inv => inv.status === 'Rejected').length,\n    overdue: invoices.filter(inv => inv.status === 'Overdue').length,\n    totalRevenue: invoices\n      .filter(inv => inv.status === 'Paid')\n      .reduce((sum, inv) => sum + inv.grandTotal, 0),\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Overdue Warning - Moved to Top */}\n      {stats.overdue > 0 && (\n        <Card className=\"border-orange-500 bg-orange-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <AlertCircle className=\"h-5 w-5 text-orange-600\" />\n              <div>\n                <p className=\"text-orange-900\">\n                  You have {stats.overdue} overdue invoice{stats.overdue > 1 ? 's' : ''}\n                </p>\n                <p className=\"text-sm text-orange-700 mt-1\">\n                  Please review and follow up on overdue payments\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Summary Cards */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-[14px] text-[#6B7280]\">Total Invoices</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-[#111827]\">{stats.total}</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-[14px] text-[#6B7280]\">Pending Payment</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-blue-600\">{stats.pending}</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-[14px] text-[#6B7280]\">Awaiting Approval</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-yellow-600\">{stats.pendingApproval}</p>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader className=\"pb-2\">\n            <CardTitle className=\"text-[14px] text-[#6B7280]\">Overdue</CardTitle>\n          </CardHeader>\n          <CardContent>\n            <p className=\"text-orange-600\">{stats.overdue}</p>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Revenue Card */}\n      <Card className=\"border-[#F15929] bg-gradient-to-br from-[#FFF7F5] to-white\">\n        <CardHeader>\n          <CardTitle className=\"text-[18px] text-[#231F20] flex items-center gap-2\">\n            <TrendingUp className=\"size-5 text-[#F15929]\" />\n            Total Paid Revenue\n          </CardTitle>\n        </CardHeader>\n        <CardContent>\n          <p className=\"text-[#F15929]\">RM {stats.totalRevenue.toLocaleString('en-MY', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}</p>\n        </CardContent>\n      </Card>\n\n      {/* Filters */}\n      <Card className=\"border-[#E5E7EB]\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex flex-col md:flex-row gap-4\">\n            <div className=\"flex-1 relative\">\n              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-[#6B7280]\" />\n              <Input\n                placeholder=\"Search by invoice number, customer name, or DO number...\"\n                value={searchQuery}\n                onChange={(e) => setSearchQuery(e.target.value)}\n                className=\"pl-10 h-10 bg-white border-[#D1D5DB] rounded-md\"\n              />\n            </div>\n            <Select value={statusFilter} onValueChange={setStatusFilter}>\n              <SelectTrigger className=\"w-full md:w-[200px] h-10 bg-white border-[#D1D5DB] rounded-md\">\n                <SelectValue placeholder=\"Filter by status\" />\n              </SelectTrigger>\n              <SelectContent>\n                <SelectItem value=\"all\">All Statuses</SelectItem>\n                <SelectItem value=\"Pending Payment\">Pending Payment</SelectItem>\n                <SelectItem value=\"Pending Approval\">Pending Approval</SelectItem>\n                <SelectItem value=\"Paid\">Paid</SelectItem>\n                <SelectItem value=\"Rejected\">Rejected</SelectItem>\n                <SelectItem value=\"Overdue\">Overdue</SelectItem>\n                <SelectItem value=\"Completed\">Completed</SelectItem>\n              </SelectContent>\n            </Select>\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Invoices Table */}\n      <Card className=\"border-[#E5E7EB]\">\n        <CardHeader>\n          <CardTitle className=\"text-[18px]\">Monthly Rental Invoices</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {filteredInvoices.length === 0 ? (\n            <div className=\"text-center py-12\">\n              <FileText className=\"mx-auto h-12 w-12 text-gray-400 mb-4\" />\n              <p className=\"text-gray-500\">No invoices found</p>\n            </div>\n          ) : (\n            <Table>\n              <TableHeader>\n                <TableRow className=\"bg-[#F9FAFB] hover:bg-[#F9FAFB]\">\n                  <TableHead>Customer</TableHead>\n                  <TableHead>DO Number</TableHead>\n                  <TableHead>Billing Month</TableHead>\n                  <TableHead>Amount</TableHead>\n                  <TableHead>Due Date</TableHead>\n                  <TableHead>Status</TableHead>\n                  <TableHead className=\"text-right\">Actions</TableHead>\n                </TableRow>\n              </TableHeader>\n              <TableBody>\n                {filteredInvoices.map((invoice) => (\n                  <TableRow key={invoice.id} className=\"h-14 hover:bg-[#F3F4F6]\">\n                    <TableCell className=\"text-[#111827]\">\n                      {invoice.customerName}\n                    </TableCell>\n                    <TableCell className=\"text-[#374151]\">{invoice.deliveryOrderNumber}</TableCell>\n                    <TableCell className=\"text-[#374151]\">\n                      Month {invoice.billingMonth}\n                    </TableCell>\n                    <TableCell className=\"text-[#111827]\">\n                      RM {invoice.grandTotal.toLocaleString('en-MY', { minimumFractionDigits: 2, maximumFractionDigits: 2 })}\n                    </TableCell>\n                    <TableCell className=\"text-[#374151]\">\n                      <div className=\"flex items-center gap-1\">\n                        <Calendar className=\"h-4 w-4 text-gray-400\" />\n                        {new Date(invoice.dueDate).toLocaleDateString()}\n                      </div>\n                    </TableCell>\n                    <TableCell>{getStatusBadge(invoice.status)}</TableCell>\n                    <TableCell className=\"text-right\">\n                      <DropdownMenu>\n                        <DropdownMenuTrigger asChild>\n                          <Button\n                            variant=\"outline\"\n                            size=\"sm\"\n                            className=\"h-8 w-8 p-0\"\n                          >\n                            <MoreVertical className=\"h-4 w-4\" />\n                          </Button>\n                        </DropdownMenuTrigger>\n                        <DropdownMenuContent align=\"end\">\n                          <DropdownMenuItem\n                            onClick={() => onView(invoice.id)}\n                          >\n                            <Eye className=\"h-4 w-4 mr-2\" />\n                            View Details\n                          </DropdownMenuItem>\n                          {invoice.status === 'Pending Payment' && onEditPayment && (\n                            <DropdownMenuItem\n                              onClick={() => onEditPayment(invoice.id)}\n                              disabled={!isBeforeDueDate(invoice.dueDate)}\n                            >\n                              <Edit className=\"h-4 w-4 mr-2\" />\n                              Edit Payment Details / Replace Proof\n                            </DropdownMenuItem>\n                          )}\n                        </DropdownMenuContent>\n                      </DropdownMenu>\n                    </TableCell>\n                  </TableRow>\n                ))}\n              </TableBody>\n            </Table>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 851, "column": 0}, "map": {"version":3,"sources":["file:///home/ervin/Documents/Power%20Metal%20%26%20Steel/src/components/monthly-rental/MonthlyRentalInvoiceDetails.tsx"],"sourcesContent":["import { useState } from 'react';\nimport { ArrowLeft, Upload, Check, X, FileText, AlertCircle, Calendar, User, Package, PackageCheck, Info } from 'lucide-react';\nimport { Button } from '../ui/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '../ui/card';\nimport { Badge } from '../ui/badge';\nimport { Input } from '../ui/input';\nimport { Label } from '../ui/label';\nimport { Textarea } from '../ui/textarea';\nimport {\n  Table,\n  TableBody,\n  TableCell,\n  TableHead,\n  TableHeader,\n  TableRow,\n} from '../ui/table';\nimport {\n  AlertDialog,\n  AlertDialogAction,\n  AlertDialogCancel,\n  AlertDialogContent,\n  AlertDialogDescription,\n  AlertDialogFooter,\n  AlertDialogHeader,\n  AlertDialogTitle,\n} from '../ui/alert-dialog';\nimport { MonthlyRentalInvoice } from '../../types/monthly-rental';\nimport { toast } from 'sonner';\n\ninterface MonthlyRentalInvoiceDetailsProps {\n  invoice: MonthlyRentalInvoice;\n  onBack: () => void;\n  onSubmitPayment: (invoiceId: string, file: File) => void;\n  onApprove: (invoiceId: string, transactionReferenceId: string) => void;\n  onReject: (invoiceId: string, reason: string) => void;\n  onMarkAsReturned: (invoiceId: string) => void;\n  userRole: 'Admin' | 'Finance' | 'Staff' | 'Customer';\n}\n\nexport function MonthlyRentalInvoiceDetails({\n  invoice,\n  onBack,\n  onSubmitPayment,\n  onApprove,\n  onReject,\n  onMarkAsReturned,\n  userRole,\n}: MonthlyRentalInvoiceDetailsProps) {\n  const [paymentFile, setPaymentFile] = useState<File | null>(null);\n  const [isApprovalModalOpen, setIsApprovalModalOpen] = useState(false);\n  const [isRejectionModalOpen, setIsRejectionModalOpen] = useState(false);\n  const [isReturnModalOpen, setIsReturnModalOpen] = useState(false);\n  const [rejectionReason, setRejectionReason] = useState('');\n  const [transactionReferenceId, setTransactionReferenceId] = useState('');\n\n  const handleFileChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.files && e.target.files[0]) {\n      setPaymentFile(e.target.files[0]);\n    }\n  };\n\n  const handleSubmitPayment = () => {\n    if (!paymentFile) {\n      toast.error('Please select a payment proof file');\n      return;\n    }\n\n    onSubmitPayment(invoice.id, paymentFile);\n  };\n\n  const handleApprove = () => {\n    if (!transactionReferenceId.trim()) {\n      toast.error('Please provide a transaction reference ID');\n      return;\n    }\n\n    setIsApprovalModalOpen(false);\n    onApprove(invoice.id, transactionReferenceId);\n    setTransactionReferenceId('');\n  };\n\n  const handleReject = () => {\n    if (!rejectionReason.trim()) {\n      toast.error('Please provide a rejection reason');\n      return;\n    }\n\n    setIsRejectionModalOpen(false);\n    onReject(invoice.id, rejectionReason);\n    setRejectionReason('');\n  };\n\n  const handleMarkAsReturned = () => {\n    setIsReturnModalOpen(false);\n    onMarkAsReturned(invoice.id);\n  };\n\n  const getStatusBadge = (status: MonthlyRentalInvoice['status']) => {\n    switch (status) {\n      case 'Paid':\n        return <Badge className=\"bg-green-600 hover:bg-green-700 text-white text-base px-4 py-1\">Paid</Badge>;\n      case 'Pending Payment':\n        return <Badge className=\"bg-[#EEF5FF] hover:bg-[#E6F0FF] text-[#2F6AE0] text-base px-4 py-1\">Pending Payment</Badge>;\n      case 'Pending Approval':\n        return <Badge className=\"bg-blue-600 hover:bg-blue-700 text-white text-base px-4 py-1\">Pending Approval</Badge>;\n      case 'Rejected':\n        return <Badge className=\"bg-red-600 hover:bg-red-700 text-white text-base px-4 py-1\">Rejected</Badge>;\n      case 'Overdue':\n        return <Badge className=\"bg-orange-600 hover:bg-orange-700 text-white text-base px-4 py-1\">Overdue</Badge>;\n      case 'Completed':\n        return <Badge className=\"bg-gray-600 hover:bg-gray-700 text-white text-base px-4 py-1\">Completed</Badge>;\n      default:\n        return <Badge>{status}</Badge>;\n    }\n  };\n\n  const isBeforeDueDate = new Date() < new Date(invoice.dueDate);\n  \n  // Consolidated upload permission - allow upload for Pending Payment, Rejected, or Overdue\n  const canUploadProof = (invoice.status === 'Pending Payment' || \n                          invoice.status === 'Rejected' || \n                          invoice.status === 'Overdue') &&\n                         !invoice.paymentProof; // Only show if no proof uploaded yet\n  \n  const canApproveReject = (userRole === 'Admin' || userRole === 'Finance') && \n    invoice.status === 'Pending Approval';\n\n  // Calculate overdue charges\n  const calculateOverdueCharges = () => {\n    // Check if invoice was overdue when payment was submitted\n    const now = new Date();\n    const dueDate = new Date(invoice.dueDate);\n    \n    // Calculate months late based on current date or payment submission date\n    const referenceDate = invoice.paymentSubmittedAt ? new Date(invoice.paymentSubmittedAt) : now;\n    const monthsDiff = (referenceDate.getFullYear() - dueDate.getFullYear()) * 12 + (referenceDate.getMonth() - dueDate.getMonth());\n    const monthsLate = Math.max(0, monthsDiff);\n    \n    // Only apply charges if payment was late\n    if (monthsLate === 0) {\n      return { monthsLate: 0, overdueCharge: 0, totalWithOverdue: invoice.grandTotal };\n    }\n    \n    // Formula: Interest = Outstanding Balance × Monthly Rate × Number of Months Late\n    const overdueCharge = invoice.grandTotal * invoice.defaultInterestRate * monthsLate;\n    const totalWithOverdue = invoice.grandTotal + overdueCharge;\n    \n    return { monthsLate, overdueCharge, totalWithOverdue };\n  };\n\n  const { monthsLate, overdueCharge, totalWithOverdue } = calculateOverdueCharges();\n  const hasOverdueCharges = overdueCharge > 0;\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <Button\n            variant=\"outline\"\n            onClick={onBack}\n            className=\"h-10\"\n          >\n            <ArrowLeft className=\"h-4 w-4 mr-2\" />\n            Back\n          </Button>\n          <div>\n            <h1 className=\"text-[#231F20]\">Invoice Details</h1>\n            <p className=\"text-sm text-gray-600 mt-1\">{invoice.invoiceNumber}</p>\n          </div>\n        </div>\n        {getStatusBadge(invoice.status)}\n      </div>\n\n      {/* Overdue Warning */}\n      {invoice.status === 'Overdue' && (\n        <Card className=\"border-orange-500 bg-orange-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <AlertCircle className=\"h-6 w-6 text-orange-600\" />\n              <div className=\"flex-1\">\n                <p className=\"text-orange-900\">Payment Overdue</p>\n                <p className=\"text-sm text-orange-700 mt-1\">\n                  This invoice is past its due date. Overdue charges of <span className=\"font-semibold\">RM {overdueCharge.toFixed(2)}</span> ({monthsLate} {monthsLate === 1 ? 'month' : 'months'} late) have been applied.\n                </p>\n                <p className=\"text-sm text-orange-700 mt-1\">\n                  Total amount due: <span className=\"font-semibold\">RM {totalWithOverdue.toFixed(2)}</span>\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Auto-Generated Notice */}\n      {invoice.isAutoGenerated && (\n        <Card className=\"border-blue-500 bg-blue-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center gap-3\">\n              <FileText className=\"h-5 w-5 text-blue-600\" />\n              <div>\n                <p className=\"text-blue-900\">\n                  {invoice.notes}\n                </p>\n                {invoice.itemsReturned && (\n                  <p className=\"text-sm text-green-700 mt-2 flex items-center gap-2\">\n                    <PackageCheck className=\"h-4 w-4\" />\n                    Rental items returned. No further billing will occur.\n                  </p>\n                )}\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Rejection Card */}\n      {invoice.status === 'Rejected' && invoice.rejectionReason && (\n        <Card className=\"border-[#DC2626] bg-[#FEF2F2]\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-start gap-3\">\n              <AlertCircle className=\"h-5 w-5 text-[#DC2626] flex-shrink-0 mt-0.5\" />\n              <div className=\"flex-1\">\n                <p className=\"text-[#991B1B]\">Payment Rejected</p>\n                <p className=\"text-sm text-gray-600 mt-1\">\n                  Reason: {invoice.rejectionReason}\n                </p>\n                <p className=\"text-sm text-gray-600 mt-2\">\n                  Please upload new payment proof below to resubmit for approval.\n                </p>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Invoice Details Grid */}\n      <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader>\n            <CardTitle className=\"text-[16px]\">Customer Information</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div>\n              <p className=\"text-sm text-gray-600\">Customer Name</p>\n              <p className=\"text-[#231F20]\">{invoice.customerName}</p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Customer ID</p>\n              <p className=\"text-[#231F20]\">{invoice.customerId}</p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Address</p>\n              <p className=\"text-[#231F20]\">{invoice.customerAddress}</p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Contact</p>\n              <p className=\"text-[#231F20]\">{invoice.customerContact}</p>\n            </div>\n          </CardContent>\n        </Card>\n\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader>\n            <CardTitle className=\"text-[16px]\">Invoice Information</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-3\">\n            <div>\n              <p className=\"text-sm text-gray-600\">Delivery Order (DO)</p>\n              <p className=\"text-[#231F20]\">{invoice.deliveryOrderNumber}</p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Agreement ID</p>\n              <p className=\"text-[#231F20]\">{invoice.agreementId}</p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Billing Month</p>\n              <p className=\"text-[#231F20]\">Month {invoice.billingMonth} of rental contract</p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Billing Period</p>\n              <p className=\"text-[#231F20]\">\n                {new Date(invoice.billingPeriodStart).toLocaleDateString()} - {new Date(invoice.billingPeriodEnd).toLocaleDateString()}\n              </p>\n            </div>\n            <div>\n              <p className=\"text-sm text-gray-600\">Due Date</p>\n              <p className=\"text-[#231F20] flex items-center gap-2\">\n                <Calendar className=\"h-4 w-4 text-gray-400\" />\n                {new Date(invoice.dueDate).toLocaleDateString()}\n              </p>\n            </div>\n            <div className=\"pt-2 border-t\">\n              <div className=\"flex items-center gap-2\">\n                <p className=\"text-sm text-[#444444] font-medium\">Default Interest (Per Month)</p>\n                <div className=\"group relative\">\n                  <Info className=\"h-4 w-4 text-gray-400 cursor-help\" />\n                  <div className=\"absolute left-0 bottom-full mb-2 hidden group-hover:block w-64 p-2 bg-gray-900 text-white text-xs rounded shadow-lg z-10\">\n                    Default interest rate specified in the rental agreement. Applied when payments are overdue.\n                  </div>\n                </div>\n              </div>\n              <p className=\"text-[#444444] font-semibold mt-1\">\n                {(invoice.defaultInterestRate * 100).toFixed(1)}% per month\n              </p>\n              <p className=\"text-xs text-gray-500 mt-1\">\n                Overdue charges will be calculated automatically based on the default interest rate.\n              </p>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n\n      {/* Rental Items Table */}\n      <Card className=\"border-[#E5E7EB]\">\n        <CardHeader>\n          <CardTitle className=\"text-[16px]\">Rental Items</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <Table>\n            <TableHeader>\n              <TableRow className=\"bg-[#F9FAFB] hover:bg-[#F9FAFB]\">\n                <TableHead>Item Name</TableHead>\n                <TableHead className=\"text-right\">Quantity</TableHead>\n                <TableHead className=\"text-right\">Unit Price (RM)</TableHead>\n                <TableHead className=\"text-center\">Rental Duration</TableHead>\n                <TableHead className=\"text-right\">Monthly Rate (RM)</TableHead>\n                <TableHead className=\"text-right\">Total (RM)</TableHead>\n              </TableRow>\n            </TableHeader>\n            <TableBody>\n              {invoice.rentalItems.map((item) => (\n                <TableRow key={item.id} className=\"hover:bg-[#F3F4F6]\">\n                  <TableCell className=\"text-[#231F20]\">{item.itemName}</TableCell>\n                  <TableCell className=\"text-right\">{item.quantity}</TableCell>\n                  <TableCell className=\"text-right\">{item.unitPrice.toFixed(2)}</TableCell>\n                  <TableCell className=\"text-center\">{item.rentalDuration}</TableCell>\n                  <TableCell className=\"text-right\">{item.monthlyRate.toFixed(2)}</TableCell>\n                  <TableCell className=\"text-right\">{item.totalPrice.toFixed(2)}</TableCell>\n                </TableRow>\n              ))}\n            </TableBody>\n          </Table>\n\n          {/* Totals */}\n          <div className=\"mt-6 border-t pt-4 space-y-2\">\n            <div className=\"flex justify-between\">\n              <span className=\"text-gray-600\">Subtotal:</span>\n              <span className=\"text-[#231F20]\">RM {invoice.subtotal.toFixed(2)}</span>\n            </div>\n            {invoice.taxRate > 0 && (\n              <div className=\"flex justify-between\">\n                <span className=\"text-gray-600\">Tax ({(invoice.taxRate * 100).toFixed(0)}%):</span>\n                <span className=\"text-[#231F20]\">RM {invoice.taxAmount.toFixed(2)}</span>\n              </div>\n            )}\n            \n            {/* Overdue Charges Section */}\n            {hasOverdueCharges && (\n              <div className=\"bg-orange-50 border border-orange-200 rounded-md p-3 space-y-2 my-2\">\n                <div className=\"flex items-center gap-2 mb-2\">\n                  <AlertCircle className=\"h-4 w-4 text-orange-600\" />\n                  <span className=\"text-sm font-medium text-orange-900\">Overdue Charges</span>\n                </div>\n                <div className=\"text-sm space-y-1 text-gray-700\">\n                  <div className=\"flex justify-between\">\n                    <span>Outstanding Balance:</span>\n                    <span>RM {invoice.grandTotal.toFixed(2)}</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Monthly Interest Rate:</span>\n                    <span>{(invoice.defaultInterestRate * 100).toFixed(1)}%</span>\n                  </div>\n                  <div className=\"flex justify-between\">\n                    <span>Months Late:</span>\n                    <span>{monthsLate} {monthsLate === 1 ? 'month' : 'months'}</span>\n                  </div>\n                  <div className=\"flex justify-between border-t border-orange-300 pt-1 mt-1\">\n                    <span className=\"font-medium text-orange-900\">Overdue Charge:</span>\n                    <span className=\"font-medium text-orange-900\">RM {overdueCharge.toFixed(2)}</span>\n                  </div>\n                  <p className=\"text-xs text-gray-600 mt-2 italic\">\n                    Calculation: RM {invoice.grandTotal.toFixed(2)} × {(invoice.defaultInterestRate * 100).toFixed(1)}% × {monthsLate} {monthsLate === 1 ? 'month' : 'months'}\n                  </p>\n                </div>\n              </div>\n            )}\n            \n            <div className=\"flex justify-between border-t pt-2\">\n              <span className=\"text-[#231F20]\">{hasOverdueCharges ? 'Original Amount:' : 'Grand Total:'}</span>\n              <span className={hasOverdueCharges ? \"text-[#231F20]\" : \"text-[#F15929]\"}>RM {invoice.grandTotal.toFixed(2)}</span>\n            </div>\n            \n            {hasOverdueCharges && (\n              <div className=\"flex justify-between border-t pt-2 bg-red-50 -mx-4 px-4 py-2\">\n                <span className=\"text-red-900 font-semibold\">Total Amount Due (with overdue charges):</span>\n                <span className=\"text-red-600 font-semibold\">RM {totalWithOverdue.toFixed(2)}</span>\n              </div>\n            )}\n          </div>\n        </CardContent>\n      </Card>\n\n      {/* Payment Proof Upload (Customer View) */}\n      {canUploadProof && (\n        <Card className=\"border-[#F15929]\">\n          <CardHeader>\n            <CardTitle className=\"text-[16px]\">Submit Payment Proof</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div>\n              <Label htmlFor=\"paymentProof\">Upload Payment Receipt/Screenshot</Label>\n              <Input\n                id=\"paymentProof\"\n                type=\"file\"\n                accept=\"image/*,.pdf\"\n                onChange={handleFileChange}\n                className=\"mt-2\"\n              />\n              {paymentFile && (\n                <p className=\"text-sm text-green-600 mt-2\">\n                  Selected: {paymentFile.name}\n                </p>\n              )}\n            </div>\n            <Button\n              onClick={handleSubmitPayment}\n              disabled={!paymentFile}\n              className=\"bg-[#F15929] hover:bg-[#D14620] text-white\"\n            >\n              <Upload className=\"h-4 w-4 mr-2\" />\n              Submit Payment Proof\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Payment Proof Review (Admin/Finance View) */}\n      {invoice.paymentProof && (\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader>\n            <CardTitle className=\"text-[16px]\">Payment Proof</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <div className=\"grid grid-cols-2 gap-4\">\n              <div>\n                <p className=\"text-sm text-gray-600\">File Name</p>\n                <p className=\"text-[#231F20]\">{invoice.paymentProof.fileName}</p>\n              </div>\n              <div>\n                <p className=\"text-sm text-gray-600\">Uploaded At</p>\n                <p className=\"text-[#231F20]\">\n                  {new Date(invoice.paymentProof.uploadedAt).toLocaleString()}\n                </p>\n              </div>\n            </div>\n            <Button variant=\"outline\" asChild>\n              <a href={invoice.paymentProof.fileUrl} target=\"_blank\" rel=\"noopener noreferrer\">\n                <FileText className=\"h-4 w-4 mr-2\" />\n                View Document\n              </a>\n            </Button>\n\n            {canApproveReject && (\n              <div className=\"flex gap-3 pt-4 border-t\">\n                <Button\n                  onClick={() => setIsApprovalModalOpen(true)}\n                  className=\"bg-green-600 hover:bg-green-700 text-white\"\n                >\n                  <Check className=\"h-4 w-4 mr-2\" />\n                  Approve Payment\n                </Button>\n                <Button\n                  onClick={() => setIsRejectionModalOpen(true)}\n                  variant=\"destructive\"\n                >\n                  <X className=\"h-4 w-4 mr-2\" />\n                  Reject Payment\n                </Button>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Paid Status Info */}\n      {invoice.status === 'Paid' && (\n        <Card className=\"border-green-500 bg-green-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <Check className=\"h-5 w-5 text-green-600\" />\n                <div>\n                  <p className=\"text-green-900\">Payment Approved</p>\n                  <p className=\"text-sm text-green-700\">\n                    Approved by {invoice.approvedBy} on {new Date(invoice.approvedAt || '').toLocaleDateString()}\n                  </p>\n                  {invoice.transactionReferenceId && (\n                    <p className=\"text-sm text-green-700 mt-1\">\n                      Transaction Reference: {invoice.transactionReferenceId}\n                    </p>\n                  )}\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Mark Items as Returned (Admin only) */}\n      {(userRole === 'Admin' || userRole === 'Staff') && invoice.status === 'Paid' && !invoice.itemsReturned && (\n        <Card className=\"border-[#E5E7EB]\">\n          <CardHeader>\n            <CardTitle className=\"text-[16px]\">Item Return Management</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <p className=\"text-sm text-gray-600\">\n              When rental items are returned, mark them as returned to stop automatic monthly billing and set the invoice status to \"Completed\".\n            </p>\n            <Button\n              onClick={() => setIsReturnModalOpen(true)}\n              variant=\"outline\"\n              className=\"border-[#F15929] text-[#F15929] hover:bg-[#FFF7F5]\"\n            >\n              <PackageCheck className=\"h-4 w-4 mr-2\" />\n              Mark Items as Returned\n            </Button>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Completed Status Info */}\n      {invoice.status === 'Completed' && (\n        <Card className=\"border-gray-500 bg-gray-50\">\n          <CardContent className=\"pt-6\">\n            <div className=\"flex items-center justify-between\">\n              <div className=\"flex items-center gap-3\">\n                <PackageCheck className=\"h-5 w-5 text-gray-600\" />\n                <div>\n                  <p className=\"text-gray-900\">Rental Completed</p>\n                  <p className=\"text-sm text-gray-700\">\n                    Items were returned on {new Date(invoice.returnedAt || '').toLocaleDateString()}\n                  </p>\n                  <p className=\"text-sm text-gray-700 mt-1\">\n                    No further invoices will be generated for this contract.\n                  </p>\n                </div>\n              </div>\n            </div>\n          </CardContent>\n        </Card>\n      )}\n\n      {/* Approval Confirmation Dialog */}\n      <AlertDialog open={isApprovalModalOpen} onOpenChange={setIsApprovalModalOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Approve Payment</AlertDialogTitle>\n            <AlertDialogDescription>\n              Are you sure you want to approve this payment? The invoice status will be updated to \"Paid\".\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          {hasOverdueCharges && (\n            <div className=\"bg-orange-50 border border-orange-200 rounded-md p-3 space-y-1\">\n              <p className=\"text-sm font-medium text-orange-900\">Note: Overdue Charges Applied</p>\n              <div className=\"text-sm text-gray-700 space-y-1\">\n                <div className=\"flex justify-between\">\n                  <span>Original Amount:</span>\n                  <span>RM {invoice.grandTotal.toFixed(2)}</span>\n                </div>\n                <div className=\"flex justify-between\">\n                  <span>Overdue Charge ({monthsLate} {monthsLate === 1 ? 'month' : 'months'} × {(invoice.defaultInterestRate * 100).toFixed(1)}%):</span>\n                  <span>RM {overdueCharge.toFixed(2)}</span>\n                </div>\n                <div className=\"flex justify-between border-t border-orange-300 pt-1 font-medium text-orange-900\">\n                  <span>Total Paid:</span>\n                  <span>RM {totalWithOverdue.toFixed(2)}</span>\n                </div>\n              </div>\n            </div>\n          )}\n          <div className=\"py-4\">\n            <Label htmlFor=\"transactionReferenceId\">Transaction Reference ID</Label>\n            <Input\n              id=\"transactionReferenceId\"\n              type=\"text\"\n              value={transactionReferenceId}\n              onChange={(e) => setTransactionReferenceId(e.target.value)}\n              className=\"mt-2\"\n              placeholder=\"Enter transaction reference ID\"\n            />\n          </div>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleApprove}\n              className=\"bg-green-600 hover:bg-green-700 text-white\"\n            >\n              Approve\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* Rejection Dialog */}\n      <AlertDialog open={isRejectionModalOpen} onOpenChange={setIsRejectionModalOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Reject Payment</AlertDialogTitle>\n            <AlertDialogDescription>\n              Please provide a reason for rejecting this payment. The customer will need to resubmit.\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <div className=\"py-4\">\n            <Textarea\n              placeholder=\"Enter rejection reason...\"\n              value={rejectionReason}\n              onChange={(e) => setRejectionReason(e.target.value)}\n              className=\"min-h-[100px]\"\n            />\n          </div>\n          <AlertDialogFooter>\n            <AlertDialogCancel onClick={() => setRejectionReason('')}>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleReject}\n              className=\"bg-red-600 hover:bg-red-700 text-white\"\n            >\n              Reject\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n\n      {/* Return Confirmation Dialog */}\n      <AlertDialog open={isReturnModalOpen} onOpenChange={setIsReturnModalOpen}>\n        <AlertDialogContent>\n          <AlertDialogHeader>\n            <AlertDialogTitle>Mark Items as Returned</AlertDialogTitle>\n            <AlertDialogDescription>\n              This will stop all future automatic billing for this contract. Are you sure the rental items have been returned and verified?\n            </AlertDialogDescription>\n          </AlertDialogHeader>\n          <AlertDialogFooter>\n            <AlertDialogCancel>Cancel</AlertDialogCancel>\n            <AlertDialogAction\n              onClick={handleMarkAsReturned}\n              className=\"bg-[#F15929] hover:bg-[#D14620] text-white\"\n            >\n              Confirm Return\n            </AlertDialogAction>\n          </AlertDialogFooter>\n        </AlertDialogContent>\n      </AlertDialog>\n    </div>\n  );\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2967, "column": 0}, "map": {"version":3,"sources":["file:///home/ervin/Documents/Power%20Metal%20%26%20Steel/src/components/monthly-rental/MonthlyRentalBilling.tsx"],"sourcesContent":["import { useState, useEffect } from 'react';\nimport { MonthlyRentalInvoiceList } from './MonthlyRentalInvoiceList';\nimport { MonthlyRentalInvoiceDetails } from './MonthlyRentalInvoiceDetails';\nimport { MonthlyRentalInvoice, RentalContract, BillingCycleLog, MonthlyRentalItem } from '../../types/monthly-rental';\nimport { toast } from 'sonner';\n\ntype View = 'list' | 'details';\n\n// Sample rental items\nconst sampleRentalItems: MonthlyRentalItem[] = [\n  {\n    id: 'item-1',\n    scaffoldingItemId: 'std-frame-1',\n    itemName: 'Standard Frame 1.8m x 1.2m',\n    quantity: 50,\n    unitPrice: 15.00,\n    rentalDuration: '30 days',\n    monthlyRate: 450.00,\n    totalPrice: 22500.00,\n  },\n  {\n    id: 'item-2',\n    scaffoldingItemId: 'cross-brace-1',\n    itemName: 'Cross Brace 1.8m',\n    quantity: 100,\n    unitPrice: 8.00,\n    rentalDuration: '30 days',\n    monthlyRate: 240.00,\n    totalPrice: 24000.00,\n  },\n  {\n    id: 'item-3',\n    scaffoldingItemId: 'base-jack-1',\n    itemName: 'Base Jack (Adjustable)',\n    quantity: 60,\n    unitPrice: 12.00,\n    rentalDuration: '30 days',\n    monthlyRate: 360.00,\n    totalPrice: 21600.00,\n  },\n];\n\nconst initialContracts: RentalContract[] = [\n  {\n    id: 'contract-1',\n    agreementId: 'AGR-2024-001',\n    deliveryOrderNumber: 'DO-2024-001',\n    customerId: 'CUST-001',\n    customerName: 'Acme Construction Ltd.',\n    customerAddress: '123 Construction Ave, Johor Bahru, Johor 81200',\n    customerContact: '+60 12-345 6789',\n    contractStartDate: '2024-10-01T00:00:00Z',\n    billingCycleDay: 1, // Bill on 1st of each month\n    rentalItems: sampleRentalItems,\n    isActive: true,\n    itemsReturned: false,\n    doSignedAt: '2024-10-01T10:00:00Z',\n    createdAt: '2024-10-01T09:00:00Z',\n    lastUpdated: '2024-10-01T09:00:00Z',\n  },\n  {\n    id: 'contract-2',\n    agreementId: 'AGR-2024-002',\n    deliveryOrderNumber: 'DO-2024-002',\n    customerId: 'CUST-002',\n    customerName: 'BuildRight Inc.',\n    customerAddress: '456 Builder Street, Kuala Lumpur 50000',\n    customerContact: '+60 13-456 7890',\n    contractStartDate: '2024-11-15T00:00:00Z',\n    billingCycleDay: 15, // Bill on 15th of each month\n    rentalItems: [\n      {\n        id: 'item-4',\n        scaffoldingItemId: 'plank-1',\n        itemName: 'Steel Plank 2.0m',\n        quantity: 80,\n        unitPrice: 20.00,\n        rentalDuration: '30 days',\n        monthlyRate: 600.00,\n        totalPrice: 48000.00,\n      },\n    ],\n    isActive: true,\n    itemsReturned: false,\n    doSignedAt: '2024-11-15T14:00:00Z',\n    createdAt: '2024-11-15T13:00:00Z',\n    lastUpdated: '2024-11-15T13:00:00Z',\n  },\n];\n\nconst initialInvoices: MonthlyRentalInvoice[] = [\n  {\n    id: 'inv-1',\n    invoiceNumber: 'INV-MR-2024-10-0001',\n    deliveryOrderNumber: 'DO-2024-001',\n    agreementId: 'AGR-2024-001',\n    customerId: 'CUST-001',\n    customerName: 'Acme Construction Ltd.',\n    customerAddress: '123 Construction Ave, Johor Bahru, Johor 81200',\n    customerContact: '+60 12-345 6789',\n    billingMonth: 1,\n    billingPeriodStart: '2024-10-01T00:00:00Z',\n    billingPeriodEnd: '2024-10-31T23:59:59Z',\n    rentalItems: sampleRentalItems,\n    subtotal: 68100.00,\n    taxRate: 0,\n    taxAmount: 0,\n    grandTotal: 68100.00,\n    defaultInterestRate: 0.015, // 1.5% per month\n    status: 'Paid',\n    dueDate: '2024-10-08T00:00:00Z',\n    createdAt: '2024-10-01T10:00:00Z',\n    lastUpdated: '2024-10-05T15:00:00Z',\n    isAutoGenerated: true,\n    autoGeneratedAt: '2024-10-01T10:00:00Z',\n    itemsReturned: false,\n    notes: 'First month invoice - automatically generated upon delivery order confirmation.',\n    paymentProof: {\n      id: 'proof-1',\n      fileName: 'payment_oct_2024.pdf',\n      fileUrl: '#',\n      fileSize: 245000,\n      fileType: 'application/pdf',\n      uploadedAt: '2024-10-03T09:00:00Z',\n    },\n    paymentSubmittedAt: '2024-10-03T09:00:00Z',\n    transactionReferenceId: 'TXN-20241003-001234',\n    approvedBy: 'Finance Manager',\n    approvedAt: '2024-10-05T15:00:00Z',\n  },\n  {\n    id: 'inv-2',\n    invoiceNumber: 'INV-MR-2024-11-0002',\n    deliveryOrderNumber: 'DO-2024-001',\n    agreementId: 'AGR-2024-001',\n    customerId: 'CUST-001',\n    customerName: 'Acme Construction Ltd.',\n    customerAddress: '123 Construction Ave, Johor Bahru, Johor 81200',\n    customerContact: '+60 12-345 6789',\n    billingMonth: 2,\n    billingPeriodStart: '2024-11-01T00:00:00Z',\n    billingPeriodEnd: '2024-11-30T23:59:59Z',\n    rentalItems: sampleRentalItems,\n    subtotal: 68100.00,\n    taxRate: 0,\n    taxAmount: 0,\n    grandTotal: 68100.00,\n    defaultInterestRate: 0.015, // 1.5% per month\n    status: 'Pending Approval',\n    dueDate: '2024-11-08T00:00:00Z',\n    createdAt: '2024-11-01T00:00:00Z',\n    lastUpdated: '2024-11-25T10:00:00Z',\n    isAutoGenerated: true,\n    autoGeneratedAt: '2024-11-01T00:00:00Z',\n    itemsReturned: false,\n    notes: 'Month 2 invoice - automatically generated as rental continues. Items have not yet been returned.',\n    paymentProof: {\n      id: 'proof-2',\n      fileName: 'payment_nov_2024.jpg',\n      fileUrl: '#',\n      fileSize: 189000,\n      fileType: 'image/jpeg',\n      uploadedAt: '2024-11-25T10:00:00Z',\n    },\n    paymentSubmittedAt: '2024-11-25T10:00:00Z',\n  },\n  {\n    id: 'inv-3',\n    invoiceNumber: 'INV-MR-2024-11-0003',\n    deliveryOrderNumber: 'DO-2024-002',\n    agreementId: 'AGR-2024-002',\n    customerId: 'CUST-002',\n    customerName: 'BuildRight Inc.',\n    customerAddress: '456 Builder Street, Kuala Lumpur 50000',\n    customerContact: '+60 13-456 7890',\n    billingMonth: 1,\n    billingPeriodStart: '2024-11-15T00:00:00Z',\n    billingPeriodEnd: '2024-12-14T23:59:59Z',\n    rentalItems: [\n      {\n        id: 'item-4',\n        scaffoldingItemId: 'plank-1',\n        itemName: 'Steel Plank 2.0m',\n        quantity: 80,\n        unitPrice: 20.00,\n        rentalDuration: '30 days',\n        monthlyRate: 600.00,\n        totalPrice: 48000.00,\n      },\n    ],\n    subtotal: 48000.00,\n    taxRate: 0,\n    taxAmount: 0,\n    grandTotal: 48000.00,\n    defaultInterestRate: 0.015, // 1.5% per month\n    status: 'Pending Payment',\n    dueDate: '2024-11-22T00:00:00Z',\n    createdAt: '2024-11-15T14:00:00Z',\n    lastUpdated: '2024-11-15T14:00:00Z',\n    isAutoGenerated: true,\n    autoGeneratedAt: '2024-11-15T14:00:00Z',\n    itemsReturned: false,\n    notes: 'First month invoice - automatically generated upon delivery order confirmation.',\n  },\n  {\n    id: 'inv-4',\n    invoiceNumber: 'INV-MR-2024-12-0004',\n    deliveryOrderNumber: 'DO-2024-001',\n    agreementId: 'AGR-2024-001',\n    customerId: 'CUST-001',\n    customerName: 'Acme Construction Ltd.',\n    customerAddress: '123 Construction Ave, Johor Bahru, Johor 81200',\n    customerContact: '+60 12-345 6789',\n    billingMonth: 3,\n    billingPeriodStart: '2024-12-01T00:00:00Z',\n    billingPeriodEnd: '2024-12-31T23:59:59Z',\n    rentalItems: sampleRentalItems,\n    subtotal: 68100.00,\n    taxRate: 0,\n    taxAmount: 0,\n    grandTotal: 68100.00,\n    defaultInterestRate: 0.015, // 1.5% per month\n    status: 'Rejected',\n    dueDate: '2024-12-15T00:00:00Z',\n    createdAt: '2024-12-01T00:00:00Z',\n    lastUpdated: '2024-12-08T14:30:00Z',\n    isAutoGenerated: true,\n    autoGeneratedAt: '2024-12-01T00:00:00Z',\n    itemsReturned: false,\n    notes: 'Month 3 invoice - automatically generated as rental continues. Items have not yet been returned.',\n    rejectedBy: 'Finance Manager',\n    rejectedAt: '2024-12-08T14:30:00Z',\n    rejectionReason: 'Payment proof image is unclear. Please upload a clearer screenshot showing transaction details and amount.',\n  },\n  {\n    id: 'inv-5',\n    invoiceNumber: 'INV-MR-2025-12-0005',\n    deliveryOrderNumber: 'DO-2024-002',\n    agreementId: 'AGR-2024-002',\n    customerId: 'CUST-002',\n    customerName: 'BuildRight Inc.',\n    customerAddress: '456 Builder Street, Kuala Lumpur 50000',\n    customerContact: '+60 13-456 7890',\n    billingMonth: 2,\n    billingPeriodStart: '2025-12-01T00:00:00Z',\n    billingPeriodEnd: '2025-12-31T23:59:59Z',\n    rentalItems: [\n      {\n        id: 'item-5',\n        scaffoldingItemId: 'plank-1',\n        itemName: 'Steel Plank 2.0m',\n        quantity: 80,\n        unitPrice: 20.00,\n        rentalDuration: '30 days',\n        monthlyRate: 600.00,\n        totalPrice: 48000.00,\n      },\n    ],\n    subtotal: 48000.00,\n    taxRate: 0,\n    taxAmount: 0,\n    grandTotal: 48000.00,\n    defaultInterestRate: 0.015, // 1.5% per month\n    status: 'Pending Payment',\n    dueDate: '2025-12-31T00:00:00Z',\n    createdAt: '2025-12-01T00:00:00Z',\n    lastUpdated: '2025-12-01T00:00:00Z',\n    isAutoGenerated: true,\n    autoGeneratedAt: '2025-12-01T00:00:00Z',\n    itemsReturned: false,\n    notes: 'Month 2 invoice - automatically generated as rental continues. Items have not yet been returned.',\n  },\n];\n\ninterface MonthlyRentalBillingProps {\n  userRole?: 'Admin' | 'Finance' | 'Staff' | 'Customer';\n}\n\nexport function MonthlyRentalBilling({ userRole = 'Admin' }: MonthlyRentalBillingProps) {\n  const [currentView, setCurrentView] = useState<View>('list');\n  const [invoices, setInvoices] = useState<MonthlyRentalInvoice[]>(initialInvoices);\n  const [contracts, setContracts] = useState<RentalContract[]>(initialContracts);\n  const [selectedInvoiceId, setSelectedInvoiceId] = useState<string | null>(null);\n  const [billingLogs, setBillingLogs] = useState<BillingCycleLog[]>([]);\n\n  // Load data from localStorage on mount\n  useEffect(() => {\n    const storedInvoices = localStorage.getItem('monthlyRentalInvoices');\n    const storedContracts = localStorage.getItem('rentalContracts');\n    const storedLogs = localStorage.getItem('billingCycleLogs');\n    \n    if (storedInvoices) {\n      try {\n        setInvoices(JSON.parse(storedInvoices));\n      } catch (e) {\n        console.error('Failed to load invoices');\n      }\n    }\n    \n    if (storedContracts) {\n      try {\n        setContracts(JSON.parse(storedContracts));\n      } catch (e) {\n        console.error('Failed to load contracts');\n      }\n    }\n    \n    if (storedLogs) {\n      try {\n        setBillingLogs(JSON.parse(storedLogs));\n      } catch (e) {\n        console.error('Failed to load billing logs');\n      }\n    }\n  }, []);\n\n  // Save to localStorage when data changes\n  useEffect(() => {\n    localStorage.setItem('monthlyRentalInvoices', JSON.stringify(invoices));\n  }, [invoices]);\n\n  useEffect(() => {\n    localStorage.setItem('rentalContracts', JSON.stringify(contracts));\n  }, [contracts]);\n\n  useEffect(() => {\n    localStorage.setItem('billingCycleLogs', JSON.stringify(billingLogs));\n  }, [billingLogs]);\n\n  // Auto-generate invoices for active contracts\n  useEffect(() => {\n    const checkAndGenerateInvoices = () => {\n      const now = new Date();\n      const today = now.getDate();\n      \n      contracts.forEach(contract => {\n        if (!contract.isActive || contract.itemsReturned) {\n          return; // Skip inactive or returned contracts\n        }\n        \n        // Check if it's billing day\n        if (today !== contract.billingCycleDay) {\n          return;\n        }\n        \n        // Calculate which billing month this should be\n        const contractStart = new Date(contract.contractStartDate);\n        const monthsDiff = (now.getFullYear() - contractStart.getFullYear()) * 12 \n          + (now.getMonth() - contractStart.getMonth());\n        const billingMonth = monthsDiff + 1;\n        \n        // Check if invoice for this month already exists\n        const existingInvoice = invoices.find(\n          inv => inv.agreementId === contract.agreementId && inv.billingMonth === billingMonth\n        );\n        \n        if (existingInvoice) {\n          return; // Invoice already generated\n        }\n        \n        // Generate new invoice\n        generateMonthlyInvoice(contract, billingMonth);\n      });\n    };\n    \n    // Check daily at midnight\n    const checkInterval = setInterval(checkAndGenerateInvoices, 24 * 60 * 60 * 1000);\n    \n    // Also check immediately on mount\n    checkAndGenerateInvoices();\n    \n    return () => clearInterval(checkInterval);\n  }, [contracts, invoices]);\n\n  // Check for overdue invoices\n  useEffect(() => {\n    const checkOverdue = () => {\n      const now = new Date();\n      now.setHours(0, 0, 0, 0);\n      \n      const updatedInvoices = invoices.map(invoice => {\n        if (invoice.status === 'Pending Payment' && !invoice.paymentProof) {\n          const dueDate = new Date(invoice.dueDate);\n          dueDate.setHours(0, 0, 0, 0);\n          \n          if (dueDate < now) {\n            return {\n              ...invoice,\n              status: 'Overdue' as const,\n              lastUpdated: new Date().toISOString(),\n            };\n          }\n        }\n        return invoice;\n      });\n      \n      const hasChanges = updatedInvoices.some((inv, i) => inv.status !== invoices[i].status);\n      if (hasChanges) {\n        setInvoices(updatedInvoices);\n      }\n    };\n    \n    checkOverdue();\n    const interval = setInterval(checkOverdue, 60000);\n    return () => clearInterval(interval);\n  }, [invoices]);\n\n  const generateMonthlyInvoice = (contract: RentalContract, billingMonth: number) => {\n    const now = new Date();\n    const invoiceNumber = `INV-MR-${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}-${String(Date.now()).slice(-4)}`;\n    \n    // Calculate billing period\n    const periodStart = new Date(contract.contractStartDate);\n    periodStart.setMonth(periodStart.getMonth() + (billingMonth - 1));\n    const periodEnd = new Date(periodStart);\n    periodEnd.setMonth(periodEnd.getMonth() + 1);\n    periodEnd.setDate(periodEnd.getDate() - 1);\n    \n    // Calculate due date (e.g., 7 days from invoice date)\n    const dueDate = new Date(now);\n    dueDate.setDate(dueDate.getDate() + 7);\n    \n    // Calculate totals\n    const subtotal = contract.rentalItems.reduce((sum, item) => sum + item.totalPrice, 0);\n    const taxRate = 0; // No tax as per requirements\n    const taxAmount = subtotal * taxRate;\n    const grandTotal = subtotal + taxAmount;\n    \n    const newInvoice: MonthlyRentalInvoice = {\n      id: `inv-${Date.now()}`,\n      invoiceNumber,\n      deliveryOrderNumber: contract.deliveryOrderNumber,\n      agreementId: contract.agreementId,\n      customerId: contract.customerId,\n      customerName: contract.customerName,\n      customerAddress: contract.customerAddress,\n      customerContact: contract.customerContact,\n      billingMonth,\n      billingPeriodStart: periodStart.toISOString(),\n      billingPeriodEnd: periodEnd.toISOString(),\n      rentalItems: contract.rentalItems,\n      subtotal,\n      taxRate,\n      taxAmount,\n      grandTotal,\n      defaultInterestRate: 0.015, // 1.5% per month\n      status: 'Pending Payment',\n      dueDate: dueDate.toISOString(),\n      createdAt: now.toISOString(),\n      lastUpdated: now.toISOString(),\n      isAutoGenerated: true,\n      autoGeneratedAt: now.toISOString(),\n      itemsReturned: false,\n      notes: billingMonth === 1\n        ? 'First month invoice - automatically generated upon delivery order confirmation.'\n        : `Month ${billingMonth} invoice - automatically generated as rental continues. Items have not yet been returned.`,\n    };\n    \n    setInvoices(prev => [...prev, newInvoice]);\n    \n    // Log the generation\n    const log: BillingCycleLog = {\n      id: `log-${Date.now()}`,\n      contractId: contract.id,\n      cycleNumber: billingMonth,\n      generatedAt: now.toISOString(),\n      invoiceId: newInvoice.id,\n      status: 'generated',\n    };\n    setBillingLogs(prev => [...prev, log]);\n    \n    toast.success(`Invoice ${invoiceNumber} generated for ${contract.customerName} - Month ${billingMonth}`);\n  };\n\n  const handleView = (id: string) => {\n    setSelectedInvoiceId(id);\n    setCurrentView('details');\n  };\n\n  const handleBack = () => {\n    setCurrentView('list');\n    setSelectedInvoiceId(null);\n  };\n\n  const handleSubmitPayment = (invoiceId: string, file: File) => {\n    const now = new Date().toISOString();\n    \n    const paymentProof = {\n      id: `proof-${Date.now()}`,\n      fileName: file.name,\n      fileUrl: URL.createObjectURL(file),\n      fileSize: file.size,\n      fileType: file.type,\n      uploadedAt: now,\n    };\n    \n    setInvoices(invoices.map(inv =>\n      inv.id === invoiceId\n        ? {\n            ...inv,\n            status: 'Pending Approval',\n            paymentProof,\n            paymentSubmittedAt: now,\n            lastUpdated: now,\n          }\n        : inv\n    ));\n    \n    toast.success('Payment proof submitted successfully');\n    setCurrentView('list');\n  };\n\n  const handleEditPayment = (invoiceId: string) => {\n    setSelectedInvoiceId(invoiceId);\n    setCurrentView('details');\n  };\n\n  const handleApprove = (invoiceId: string, transactionReferenceId: string) => {\n    const now = new Date().toISOString();\n    \n    setInvoices(invoices.map(inv =>\n      inv.id === invoiceId\n        ? {\n            ...inv,\n            status: 'Paid',\n            transactionReferenceId,\n            approvedBy: 'Current User (Admin)',\n            approvedAt: now,\n            lastUpdated: now,\n          }\n        : inv\n    ));\n    \n    toast.success('Payment approved successfully');\n    setCurrentView('list');\n  };\n\n  const handleReject = (invoiceId: string, reason: string) => {\n    const now = new Date().toISOString();\n    \n    setInvoices(invoices.map(inv =>\n      inv.id === invoiceId\n        ? {\n            ...inv,\n            status: 'Rejected',\n            rejectedBy: 'Current User (Admin)',\n            rejectedAt: now,\n            rejectionReason: reason,\n            paymentProof: undefined, // Clear payment proof on rejection\n            lastUpdated: now,\n          }\n        : inv\n    ));\n    \n    toast.error('Payment rejected');\n    setCurrentView('list');\n  };\n\n  const handleMarkAsReturned = (invoiceId: string) => {\n    const invoice = invoices.find(inv => inv.id === invoiceId);\n    if (!invoice) return;\n    \n    const now = new Date().toISOString();\n    \n    // Update the invoice - mark as completed\n    setInvoices(invoices.map(inv =>\n      inv.id === invoiceId\n        ? {\n            ...inv,\n            status: 'Completed' as const,\n            itemsReturned: true,\n            returnedAt: now,\n            lastUpdated: now,\n          }\n        : inv\n    ));\n    \n    // Update the contract to stop future billing\n    setContracts(contracts.map(contract =>\n      contract.agreementId === invoice.agreementId\n        ? {\n            ...contract,\n            itemsReturned: true,\n            returnDate: now,\n            isActive: false,\n            lastUpdated: now,\n          }\n        : contract\n    ));\n    \n    toast.success('Items marked as returned. No further invoices will be generated.');\n  };\n\n  const selectedInvoice = selectedInvoiceId\n    ? invoices.find(inv => inv.id === selectedInvoiceId)\n    : null;\n\n  return (\n    <div className=\"space-y-6\">\n      {currentView === 'list' && (\n        <>\n          <div className=\"space-y-2\">\n            <h1>Monthly Rental Billing</h1>\n            <p className=\"text-[#374151]\">\n              Automated monthly rental invoicing with payment tracking and approval workflows\n            </p>\n          </div>\n          \n          <MonthlyRentalInvoiceList\n            invoices={invoices}\n            onView={handleView}\n            onEditPayment={handleEditPayment}\n            userRole={userRole}\n          />\n        </>\n      )}\n      \n      {currentView === 'details' && selectedInvoice && (\n        <MonthlyRentalInvoiceDetails\n          invoice={selectedInvoice}\n          onBack={handleBack}\n          onSubmitPayment={handleSubmitPayment}\n          onApprove={handleApprove}\n          onReject={handleReject}\n          onMarkAsReturned={handleMarkAsReturned}\n          userRole={userRole}\n        />\n      )}\n    </div>\n  );\n}"],"names":[],"mappings":"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"}}]
}